```{r setup-clipol, results=FALSE, message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      fig.width = 7,
                      fig.height = 5,
                      fig.align = 'left')
library(ggplot2)
library(tidyverse)
library(readxl)
library(dplyr)

source('gradu_read_data.R', encoding = 'UTF-8')
```

# Sensitivity checks

Here can be seen few different IRF plots with different choices with endogenous variables. This will bring some insight how sensitive the results of my thesis are on the choices made with the selection of endogenous variables and the choices made on the

## Seasonally varying endogenous variables {#seasonapp}

In the figure below it can be seen that the model captures a significant seasonal variation to the greenhouse gas emissions. It is also unplausible to consider that a modest price shock would raise the Finnish unemployment rate by two percentage points. This is an excellent argument against using the seasonally varying data. As I demonstrated in the chapter \@ref(diagextinst) that the regulatory dates are accumulated on same times of the year, this could then combined with the seasonally varying Greenhouse gas data and seasonally varying unemployment data explain the impulse responses seen below. Also in this model is used the seasonally varying industrial production index, the 

```{r include-sens-irf1, echo=FALSE, fig.cap='The IRFs with my seasonally agressively varying GHG emissions and with the not seasonally adjusted unemployment rates as endogenous variables.'}

knitr::include_graphics("Slide_pictures/var_my_GHG.png")

```

My aim is not to explain this unusual impulse response functions but to use it as an argument on behalf of using data from where the seasonal variation is cleaned out. Reassuringly the main findings of my thesis are still, at least qualitatively present even though this is a model with endogenous variables that have seasonal variation.

## Omitting GHG emissions

To test whether the large contemporaneous effects in industrial production and unemployment rate are solely due to the substantially varying greenhouse gas data. I will in this model I have omitted the Greenhouse gas emissions from the model. 

```{r include-sens-irf2, echo=FALSE, fig.cap= 'Omitting the Greenhouse gas data from my endogenous variables. It can be seen that the results of the IRF are at least qualitatively similar as the ones reported in my main findings.'}

knitr::include_graphics("Slide_pictures/var_no_GHG.png")

```

As can be seen from the figure \@ref(fig:include-sens-irf2) the large contemporaneous effects are still present and thus it could be interpreted as evidence for using the trend values, I have utilised in the core model I have presented. It is reassuring that if the contemporaneous effects are ignored the effects are similar to the core model. This could be interpreted to indicate that the drastic contemporaneous effects are due to seasonal variation. Yet again my aim here is not to prove this. But on contrary, I will the counter I will provide these as an argument for the selection of the endogenous variables in my core model. Additionally, these two figures suggest that the core findings of my thesis are robust to a wide variety of choices in handling the endogenous variables.

## Local projection {#localprojapp}

In this subchapter I will produce local projection impulse responses as used in the supplementary material of @plagborg2021local

```{r local-project, echo=FALSE, fig.cap='The local projections made',fig.height = 15, fig.width=10}

data <- get_useful_data() %>% 
  select(HCIP_energy, 
         GHG_KÃ¤nzig_method, 
         HCIP, ind_adj, 
         Euribor_3kk, 
         unemp_adj, 
         omx_hel_25, 
         RBFIBIS) %>% 
  as.data.frame()

z <- get_useful_data() %>%
  select(monthly_sum)%>% 
  as.data.frame()

local_projection <- lpirfs::lp_lin_iv(endog_data = data, 
                  shock = z, 
                  num_cores = NULL, 
                  lags_endog_lin = 12, 
                  trend = 2,
                  confint = 1.65,
                  hor = 50)


lpirfs::plot.lpirfs_lin_iv_obj(local_projection)

```

## Delta-method for @montiel2021




\newpage
\singlespacing
